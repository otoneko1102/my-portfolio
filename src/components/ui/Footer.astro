---
import { siteConfig } from "../../settings/config.js";

const startYear = 2022;
let buildYear;
try {
  buildYear = Number(
    new Intl.DateTimeFormat("en", {
      timeZone: "Asia/Tokyo",
      year: "numeric",
    }).format(new Date())
  );
} catch (e) {
  const now = new Date();
  const jst = new Date(now.getTime() + 9 * 60 * 60 * 1000);
  buildYear = jst.getUTCFullYear();
}
const buildYearText =
  buildYear > startYear ? `${startYear} - ${buildYear}` : `${startYear}`;
---

<footer>
  <div class="footer-content">
    <p>
      <span id="copyright-year">{buildYearText}</span> &copy; {
        siteConfig.author
      } - All rights reserved.
    </p>
  </div>
</footer>

<script>
  (function () {
    try {
      const startYear = 2022;
      let currentYear;
      try {
        currentYear = Number(
          new Intl.DateTimeFormat("en", {
            timeZone: "Asia/Tokyo",
            year: "numeric",
          }).format(new Date())
        );
      } catch (e) {
        const now = new Date();
        const jst = new Date(now.getTime() + 9 * 60 * 60 * 1000);
        currentYear = jst.getUTCFullYear();
      }
      const el = document.getElementById("copyright-year");
      if (!el) return;
      el.textContent =
        currentYear > startYear
          ? `${startYear} - ${currentYear}`
          : `${startYear}`;
    } catch (e) {
      // ignore
    }
  })();
</script>

<style>
  footer {
    position: fixed;
    left: 0;
    bottom: 0;
    width: 100%;
    z-index: 60;
    background-color: rgba(248, 248, 248, 0.35);
    border-top: 1px solid rgba(0, 0, 0, 0.025);
    padding: var(--footer-padding-y) var(--footer-padding-x);

    padding-bottom: calc(var(--footer-padding-y) + env(safe-area-inset-bottom));
    text-align: center;
    margin-top: 0;
    box-shadow: 0 -1px 6px rgba(0, 0, 0, 0.02);
    backdrop-filter: blur(6px);
    -webkit-backdrop-filter: blur(6px);
  }

  .footer-content {
    max-width: 1200px;
    margin: 0 auto;
  }

  footer p {
    font-size: var(--font-size-xs);
    color: var(--color-text);
    margin: 0;
    font-weight: 500;
  }
</style>
